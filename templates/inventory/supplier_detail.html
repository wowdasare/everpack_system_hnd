{% extends 'base.html' %}

{% block title %}{{ supplier.name }} - Supplier Details - EverPack System{% endblock %}

{% block page_title %}
    <i class="bi bi-truck"></i> Supplier Details
{% endblock %}

{% block page_actions %}
    <a href="{% url 'inventory:supplier_edit' supplier.pk %}" class="btn btn-warning">
        <i class="bi bi-pencil"></i> Edit Supplier
    </a>
    <a href="{% url 'inventory:supplier_list' %}" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> Back to Suppliers
    </a>
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-building"></i> {{ supplier.name }}
                    {% if supplier.is_active %}
                        <span class="badge bg-success ms-2">Active</span>
                    {% else %}
                        <span class="badge bg-secondary ms-2">Inactive</span>
                    {% endif %}
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6 class="text-muted">Contact Information</h6>
                        <p class="mb-1">
                            <strong>Contact Person:</strong> {{ supplier.contact_person }}
                        </p>
                        <p class="mb-1">
                            <strong>Phone:</strong> {{ supplier.phone }}
                        </p>
                        <p class="mb-3">
                            <strong>Email:</strong> {{ supplier.email|default:"Not provided" }}
                        </p>
                    </div>
                    <div class="col-md-6">
                        <h6 class="text-muted">Business Details</h6>
                        <p class="mb-1">
                            <strong>Created:</strong> {{ supplier.created_at|date:"M d, Y" }}
                        </p>
                        <p class="mb-1">
                            <strong>Last Updated:</strong> {{ supplier.updated_at|date:"M d, Y H:i" }}
                        </p>
                    </div>
                </div>
                
                <h6 class="text-muted">Address</h6>
                <p class="mb-3">{{ supplier.address }}</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h6 class="card-title mb-0">
                    <i class="bi bi-graph-up"></i> Statistics
                </h6>
            </div>
            <div class="card-body">
                <div class="text-center">
                    <h3 class="text-primary">{{ supplier.products.count }}</h3>
                    <p class="text-muted">Products Supplied</p>
                </div>
                <hr>
                <div class="text-center">
                    <h5 class="text-success">{{ active_products_count }}</h5>
                    <p class="text-muted">Active Products</p>
                </div>
            </div>
        </div>
    </div>
</div>

{% if supplier.products.exists %}
<div class="card mt-4">
    <div class="card-header">
        <h6 class="card-title mb-0">
            <i class="bi bi-boxes"></i> Products from {{ supplier.name }}
        </h6>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-sm">
                <thead class="table-light">
                    <tr>
                        <th>SKU</th>
                        <th>Product Name</th>
                        <th>Category</th>
                        <th>Current Stock</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in supplier.products.all %}
                    <tr>
                        <td><code>{{ product.sku }}</code></td>
                        <td>{{ product.name }}</td>
                        <td>{{ product.category.name }}</td>
                        <td>
                            <span class="badge {% if product.is_low_stock %}bg-warning{% elif product.current_stock == 0 %}bg-danger{% else %}bg-success{% endif %}">
                                {{ product.current_stock }} {{ product.get_unit_display }}
                            </span>
                        </td>
                        <td>
                            {% if product.is_active %}
                                <span class="badge bg-success">Active</span>
                            {% else %}
                                <span class="badge bg-secondary">Inactive</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'inventory:product_detail' product.pk %}" class="btn btn-outline-primary btn-sm" title="View Product">
                                <i class="bi bi-eye"></i>
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}